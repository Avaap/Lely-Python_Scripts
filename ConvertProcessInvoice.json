[{"name":"ISPConvertProcessInvoice","description":"ISP Convert Process Invoice to JSON","scriptCode":"import json as j\r\nimport xml.etree.ElementTree as e\r\nfrom xml.etree import ElementTree\r\n# a Python object (dict):\r\nx = input\r\ny = j.loads(x)\r\n\r\naction =''\r\nif 'ProcessInvoice' in y:\r\n    action ='ProcessInvoice'\r\nelif 'ApproveInvoice' in y:\r\n    action ='ApproveInvoice'\r\nelif 'CancelInvoice' in y:\r\n    action ='CancelInvoice'\r\nelif 'RegisterInvoice' in y:\r\n    action='RegisterInvoice'\r\nelif 'RecodeInvoice' in y:\r\n    action ='RecodeInvoice'\r\nr = e.Element(action)\r\n\r\ndef setInvoice():\r\n    if 'Invoice' in y[action]:\r\n        invoice = e.SubElement(r,\"Invoice\")\r\n        for invoicetag in y[action]['Invoice']:\r\n            e.SubElement(invoice,invoicetag).text = str(y[action]['Invoice'][invoicetag])\r\n\r\ndef setHeader():\r\n    if 'InvoiceHeader' in y[action]:\r\n        invoiceHeader = e.SubElement(r,\"InvoiceHeader\")\r\n        for headertag in y[action]['InvoiceHeader']:\r\n            if y[action]['InvoiceHeader'][headertag]:\r\n                e.SubElement(invoiceHeader,headertag).text = str(y[action]['InvoiceHeader'][headertag])\r\n            else:\r\n                e.SubElement(invoiceHeader,headertag).text = ''\r\n\r\ndef setHeaderCharges():\r\n    if 'HeaderCharges' in y[action]:\r\n        headerCharges = e.SubElement(r,\"HeaderCharges\")\r\n        for chargestag in y[action]['HeaderCharges']:\r\n            headerCharge = e.SubElement(headerCharges,'HeaderCharge')\r\n            for eachChargeTag in chargestag:\r\n                e.SubElement(headerCharge,eachChargeTag).text = str(chargestag[eachChargeTag])\r\n\r\ndef setItemLines():\r\n    if 'ItemLines' in y[action]:\r\n        itemLines = e.SubElement(r,'ItemLines')\r\n        for linestag in y[action]['ItemLines']:\r\n            itemLine = e.SubElement(itemLines,'ItemLine')\r\n            for eachLinetag in linestag:\r\n                e.SubElement(itemLine,eachLinetag).text = str(linestag[eachLinetag])\r\n\r\ndef setLineCharges():\r\n    if 'LineCharges' in y[action]:\r\n        lineCharges = e.SubElement(r,'LineCharges')\r\n        for lineChargestag in y[action]['LineCharges']:\r\n            lineCharge = e.SubElement(lineCharges,'LineCharge')\r\n            for eachLineChargetag in lineChargestag:\r\n                e.SubElement(lineCharge,eachLineChargetag).text = str(lineChargestag[eachLineChargetag])\r\n\r\ndef setVATLines():\r\n    if 'VATLines' in y[action]:\r\n        vatLines = e.SubElement(r,'VATLines')\r\n        for vatLinesTag in y[action]['VATLines']:\r\n            vatLine = e.SubElement(vatLines,'VATLine')\r\n            for eachVatLine in vatLinesTag:\r\n                e.SubElement(vatLine,eachVatLine).text = str(vatLinesTag[eachVatLine])\r\n\r\ndef setCostLines():\r\n    if 'CostLines' in y[action]:\r\n        costLines = e.SubElement(r,'CostLines')\r\n        for costLinesTag in y[action]['CostLines']:\r\n            costLine = e.SubElement(costLines,'CostLine')\r\n            for eachCostLine in costLinesTag:\r\n                if costLinesTag[eachCostLine]:\r\n                    e.SubElement(costLine,eachCostLine).text = str(costLinesTag[eachCostLine])\r\n                else:\r\n                   e.SubElement(costLine,eachCostLine).text = '' \r\n\r\nsetInvoice()\r\nsetHeader()\r\nsetHeaderCharges()\r\nsetItemLines()\r\nsetLineCharges()\r\nsetVATLines()\r\nsetCostLines()\r\noutput = ElementTree.tostring(r,encoding=\"unicode\")\r\n\r\n\r\n","documentation":"","usedLibraries":[],"inputVariables":[],"outputVariables":[],"variables":[{"name":"input","description":"","dataType":"STRING","type":"INPUT","content":null},{"name":"output","description":"","dataType":"STRING","type":"OUTPUT","content":null}]}]